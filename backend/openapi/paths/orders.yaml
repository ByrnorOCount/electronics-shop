'orders':
  get:
    summary: Get user's order history
    description: Retrieves a list of all past orders for the logged-in user.
    operationId: getOrderHistory
    tags:
      - Orders
    security:
      - bearerAuth: []
    responses:
      '200':
        description: An array of the user's orders.
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '../components/schemas.yaml#/Order'
      '401':
        description: Unauthorized.

  post:
    summary: Create a new order (Checkout)
    description: Creates a new **Cash on Delivery (COD)** order from the user's current cart after verifying a One-Time Password (OTP). This action will clear the cart. For online payments, use the `/orders/create-payment-session` endpoint first.
    operationId: createOrder
    tags:
      - Orders
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas.yaml#/CreateOrderRequest'
    responses:
      '201':
        description: Order created successfully.
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/Order'
      '400':
        description: Bad request (e.g., empty cart).

'orders/generate-otp':
  post:
    summary: Generate OTP for checkout
    description: Generates a One-Time Password (OTP) and sends it to the user's email for checkout verification. The OTP is valid for 10 minutes.
    operationId: generateCheckoutOtp
    tags:
      - Orders
    security:
      - bearerAuth: []
    responses:
      '200':
        description: OTP sent successfully.
      '401':
        description: Unauthorized.
      '500':
        description: Server error while generating OTP.

'orders/create-payment-session':
  post:
    summary: Create a payment session for online payments
    description: Initiates a payment session with an online provider like Stripe or VNPay. Returns a URL for the user to complete the payment. An order is created via webhook upon successful payment.
    operationId: createPaymentSession
    tags:
      - Orders
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas.yaml#/CreatePaymentSessionRequest'
    responses:
      '200':
        description: Payment session created successfully.
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
      '400':
        description: Bad request (e.g., empty cart, invalid payment method).
